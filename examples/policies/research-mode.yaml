# Research Mode Policy
#
# Policy for research tasks - heavy on reading and web access,
# but no file modifications allowed without approval.

name: research-mode
description: Read-only with web access for research tasks

enforce_trifecta: true

constraints:
  # No writes in research mode
  - name: no-writes
    description: Research mode is read-only
    condition: |
      operation == "write_files" || operation == "edit_files"
    obligations:
      - write_files
      - edit_files

  # No git operations in research mode
  - name: no-git
    description: No git operations during research
    condition: |
      operation == "git_commit" || operation == "git_push" || operation == "create_pr"
    obligations:
      - git_commit
      - git_push
      - create_pr

  # No bash in research mode
  - name: no-bash
    description: No command execution during research
    condition: |
      operation == "run_bash"
    obligations:
      - run_bash

  # Allow reads but protect sensitive files
  - name: protect-secrets
    description: Require approval for credential files
    condition: |
      operation == "read_files" &&
      (path.contains("/credentials") ||
       path.contains("/secrets") ||
       path.endsWith(".pem") ||
       path.endsWith(".key"))
    obligations:
      - read_files
